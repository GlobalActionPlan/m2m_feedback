<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      metal:use-macro="view.macro('arche_m2m:templates/master_stripped.pt')"
      i18n:domain="arche_m2m">
  <div metal:fill-slot="content">
    <div class="row">
      <div class="col-md-12">
        <br/>
        <div class="progress" tal:define="(completed, current) view.calc_percentages()">
          <div class="progress-bar progress-bar-success" style="width: ${completed}%"></div>
          <div class="progress-bar progress-bar-warning progress-bar-striped" style="width: ${current}%"></div>
        </div>
        <p>FIXME: Feedback here</p>
        <tal:section repeat="section view.get_referenced_sections()">
          <h3>${section.title}</h3>
          
          As an example:
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Question</th>
                <th>Choice</th>
                <th>Score</th>
              </tr>
            </thead>
            <tbody>
              <tal:iterate repeat="question view.get_questions(section)">
                <tr>
                  <td>${question.title}</td>
                  <td tal:define="choice view.get_picked_choice(section, question)">${choice.title|''}</td>
                  <td>${view.get_picked_choice_score(section, question)}</td>
                </tr>
              </tal:iterate>
            </tbody>
          </table>
        </tal:section>

        <p>&nbsp;</p>

        <form tal:replace="structure form" />
      </div>
    </div>
    <script type="text/javascript">
      $(document).ready(function() {
        $("form input").keypress(function (e) {
          if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {
            $('button.submit-default').click();
            return false;
          } else {
            return true;
          }
        });
      });
    </script>
  </div>
</html>
